# ç³»çµ±ç›£æ§ä½¿ç”¨æŒ‡å—

## ğŸ“Š åŠŸèƒ½èªªæ˜

æˆ‘å·²ç¶“ç‚ºä½ çš„ç¦ªæ„äº”å­æ£‹ç³»çµ±æ–°å¢äº†å®Œæ•´çš„ç›£æ§åŠŸèƒ½ï¼Œå¯ä»¥å³æ™‚è¿½è¹¤ï¼š

- âœ… æ´»èºæˆ¿é–“æ•¸é‡
- âœ… ç·šä¸Šç©å®¶äººæ•¸
- âœ… è¨˜æ†¶é«”ä½¿ç”¨ç‡
- âœ… ç³»çµ±é‹è¡Œæ™‚é–“
- âœ… ç†è«–å®¹é‡ä¸Šé™

---

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. å•Ÿå‹•ä¼ºæœå™¨

```bash
cd server
npm run dev
```

### 2. æŸ¥çœ‹å³æ™‚ç›£æ§ï¼ˆæ¨è–¦ï¼‰

**ä½¿ç”¨ç›£æ§è…³æœ¬ï¼š**
```bash
node monitor.js
```

æˆ–è€…æŒ‡å®šç”Ÿç”¢ä¼ºæœå™¨ï¼š
```bash
node monitor.js https://zen-gomoku-server.onrender.com
```

**æ•ˆæœé è¦½ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ğŸ® ç¦ªæ„äº”å­æ£‹ - ç³»çµ±ç›£æ§å„€è¡¨æ¿                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸŸ¢ ç³»çµ±ç‹€æ…‹ï¼šOK
ğŸ• æ›´æ–°æ™‚é–“ï¼š2026-01-03 14:30:25
â±ï¸  é‹è¡Œæ™‚é–“ï¼š2h 15m 30s

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ğŸ“Š æˆ¿é–“çµ±è¨ˆ                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  æ´»èºæˆ¿é–“ï¼š42 å€‹
  ç†è«–ä¸Šé™ï¼š8,500 å€‹
  ä½¿ç”¨ç‡  ï¼š0.49%

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ğŸ‘¥ ç©å®¶é€£ç·š                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  ç·šä¸Šç©å®¶ï¼š78 äºº
  ç†è«–ä¸Šé™ï¼š84 äºº (æ¯æˆ¿é–“ 2 äºº)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ğŸ’¾ è¨˜æ†¶é«”ä½¿ç”¨                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  å †ç©ç¸½é‡ï¼š85.5 MB
  å †ç©ä½¿ç”¨ï¼š42.3 MB
  ä½¿ç”¨ç‡  ï¼š49.47%
  RSS     ï¼š120.5 MB
  å¤–éƒ¨ç¶å®šï¼š1.2 MB

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     â¤ï¸  ç³»çµ±å¥åº·åº¦                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  ğŸŸ¢ å¥åº· (è¨˜æ†¶é«”ä½¿ç”¨ç‡: 49.47%)
```

---

### 3. æ‰‹å‹•æŸ¥è©¢ API

#### åŸºæœ¬å¥åº·æª¢æŸ¥
```bash
curl http://localhost:3000/health
```

**å›æ‡‰ç¯„ä¾‹ï¼š**
```json
{
  "status": "ok",
  "rooms": 5,
  "timestamp": "2026-01-03T06:30:25.123Z"
}
```

#### è©³ç´°ç³»çµ±æŒ‡æ¨™
```bash
curl http://localhost:3000/metrics
```

**å›æ‡‰ç¯„ä¾‹ï¼š**
```json
{
  "status": "ok",
  "timestamp": "2026-01-03T06:30:25.123Z",
  "uptime": {
    "seconds": 8130,
    "formatted": "2h 15m 30s"
  },
  "rooms": {
    "active": 42,
    "maxEstimated": 8500
  },
  "connections": {
    "active": 78
  },
  "memory": {
    "rss": "120.5 MB",
    "heapTotal": "85.5 MB",
    "heapUsed": "42.3 MB",
    "external": "1.2 MB",
    "heapUsagePercent": "49.47%"
  },
  "environment": {
    "nodeVersion": "v18.17.0",
    "platform": "linux",
    "arch": "x64"
  }
}
```

---

## ğŸ“ˆ å¥åº·åº¦æŒ‡æ¨™èªªæ˜

### è¨˜æ†¶é«”ä½¿ç”¨ç‡ç­‰ç´š

| ä½¿ç”¨ç‡ | ç‹€æ…‹ | åœ–ç¤º | èªªæ˜ |
|--------|------|------|------|
| 0-50% | å¥åº· | ğŸŸ¢ | ç³»çµ±é‹ä½œæ­£å¸¸ |
| 50-75% | æ­£å¸¸ | ğŸŸ¡ | æ­£å¸¸è² è¼‰ |
| 75-90% | è­¦å‘Š | ğŸŸ  | å»ºè­°ç›£æ§ |
| 90-100% | å±éšª | ğŸ”´ | éœ€è¦ç«‹å³è™•ç† |

### å®¹é‡è¨ˆç®—å…¬å¼

```
ç†è«–æœ€å¤§æˆ¿é–“æ•¸ = (å †ç©ç¸½é‡ - å †ç©ä½¿ç”¨) Ã· 2.3 KB
æ¯å€‹æˆ¿é–“å¹³å‡è¨˜æ†¶é«” = 2.3 KB (15Ã—15 æ£‹ç›¤ + å…ƒæ•¸æ“š)
```

---

## ğŸ”§ æ•´åˆåˆ°ç›£æ§ç³»çµ±

### æ–¹æ¡ˆ 1ï¼šä½¿ç”¨ Uptime Robotï¼ˆå…è²»ï¼‰

1. è¨»å†Š [Uptime Robot](https://uptimerobot.com/)
2. æ–°å¢ç›£æ§ï¼š
   - **Type**: HTTP(s)
   - **URL**: `https://zen-gomoku-server.onrender.com/health`
   - **Interval**: 5 åˆ†é˜
3. è¨­å®šè­¦å ±ï¼šç•¶ `status !== "ok"` æ™‚ç™¼é€ Email

---

### æ–¹æ¡ˆ 2ï¼šä½¿ç”¨ Grafana + Prometheusï¼ˆé€²éšï¼‰

1. å®‰è£ Prometheus Node Exporter
2. ä¿®æ”¹ `/metrics` ç«¯é»è¼¸å‡ºç‚º Prometheus æ ¼å¼
3. è¨­å®š Grafana Dashboard

**ç¯„ä¾‹ç¨‹å¼ç¢¼ï¼š**
```typescript
// server/src/index.ts
import { register, Counter, Gauge } from 'prom-client';

const roomsGauge = new Gauge({
  name: 'gomoku_active_rooms',
  help: 'Number of active game rooms'
});

app.get('/metrics', (req, res) => {
  roomsGauge.set(roomManager.getRoomCount());
  res.set('Content-Type', register.contentType);
  res.end(register.metrics());
});
```

---

## ğŸš¨ ç›£æ§è­¦å ±è¨­å®šå»ºè­°

### é—œéµæŒ‡æ¨™è­¦å ±

| æŒ‡æ¨™ | è­¦å‘Šé–¾å€¼ | å±éšªé–¾å€¼ | è™•ç†æªæ–½ |
|------|----------|----------|----------|
| è¨˜æ†¶é«”ä½¿ç”¨ç‡ | > 75% | > 90% | é‡å•Ÿæœå‹™ / å‡ç´šæ–¹æ¡ˆ |
| æ´»èºæˆ¿é–“æ•¸ | > 5000 | > 8000 | æ¸…ç†é–’ç½®æˆ¿é–“ |
| é€£ç·šæ•¸ | > 100 | > 200 | æª¢æŸ¥æ˜¯å¦æ”»æ“Š |
| é‹è¡Œæ™‚é–“ | N/A | > 7 å¤© | å®šæœŸé‡å•Ÿï¼ˆè¨˜æ†¶é«”æ´©æ¼ï¼‰ |

---

## ğŸ“Š ç”Ÿç”¢ç’°å¢ƒç›£æ§ç¯„ä¾‹

### Render éƒ¨ç½²å¾Œçš„ç›£æ§

**å¥åº·æª¢æŸ¥ URLï¼š**
```
https://zen-gomoku-server.onrender.com/health
https://zen-gomoku-server.onrender.com/metrics
```

**åœ¨ç€è¦½å™¨ä¸­æŸ¥çœ‹ï¼š**
1. æ‰“é–‹ https://zen-gomoku-server.onrender.com/metrics
2. å®‰è£ JSONView ç€è¦½å™¨æ“´å……åŠŸèƒ½ï¼ˆç¾åŒ– JSONï¼‰
3. æ›¸ç±¤æ­¤é é¢ï¼Œå®šæœŸæŸ¥çœ‹

---

## ğŸ› ï¸ ç–‘é›£æ’è§£

### å•é¡Œ 1ï¼šç›£æ§è…³æœ¬ç„¡æ³•é€£ç·š

**éŒ¯èª¤è¨Šæ¯ï¼š**
```
âŒ é€£ç·šå¤±æ•—: connect ECONNREFUSED
```

**è§£æ±ºæ–¹æ³•ï¼š**
```bash
# 1. ç¢ºèªä¼ºæœå™¨å·²å•Ÿå‹•
cd server
npm run dev

# 2. æª¢æŸ¥ç«¯å£æ˜¯å¦æ­£ç¢º
lsof -i :3000  # Mac/Linux
netstat -ano | findstr :3000  # Windows

# 3. å˜—è©¦ä½¿ç”¨å®Œæ•´ URL
node monitor.js http://localhost:3000
```

---

### å•é¡Œ 2ï¼šè¨˜æ†¶é«”ä½¿ç”¨ç‡æŒçºŒä¸Šå‡

**å¯èƒ½åŸå› ï¼š**
- è¨˜æ†¶é«”æ´©æ¼
- æˆ¿é–“æœªæ­£ç¢ºæ¸…ç†

**è¨ºæ–·æ­¥é©Ÿï¼š**
```bash
# 1. æª¢æŸ¥æˆ¿é–“æ•¸é‡
curl http://localhost:3000/health

# 2. æ‰‹å‹•è§¸ç™¼æ¸…ç†
# ä¿®æ”¹ server/src/index.ts:
roomManager.cleanupIdleRooms();  // ç«‹å³åŸ·è¡Œ

# 3. é‡å•Ÿä¼ºæœå™¨
pm2 restart zen-gomoku-server
```

---

### å•é¡Œ 3ï¼šRender Free Plan ç¡çœ 

**ç¾è±¡ï¼š**
- 15 åˆ†é˜ç„¡æ´»å‹•å¾Œï¼Œä¼ºæœå™¨é€²å…¥ç¡çœ 
- é¦–æ¬¡è«‹æ±‚éœ€è¦ 30-60 ç§’å–šé†’

**è§£æ±ºæ–¹æ¡ˆï¼š**
```bash
# ä½¿ç”¨ cron-job.org å®šæœŸ ping
curl https://zen-gomoku-server.onrender.com/health

# æ¯ 10 åˆ†é˜åŸ·è¡Œä¸€æ¬¡ï¼ˆé˜²æ­¢ç¡çœ ï¼‰
```

---

## ğŸ“ ç›£æ§æ—¥èªŒç¯„ä¾‹

### æ­£å¸¸é‹è¡Œ
```
[2026-01-03 14:30:25] âœ… æˆ¿é–“: 42 | é€£ç·š: 78 | è¨˜æ†¶é«”: 49.47%
[2026-01-03 14:30:30] âœ… æˆ¿é–“: 43 | é€£ç·š: 82 | è¨˜æ†¶é«”: 50.12%
```

### ç•°å¸¸æƒ…æ³
```
[2026-01-03 15:20:10] âš ï¸ æˆ¿é–“: 8523 | é€£ç·š: 15234 | è¨˜æ†¶é«”: 87.34%
[2026-01-03 15:20:15] ğŸ”´ æˆ¿é–“: 8891 | é€£ç·š: 16012 | è¨˜æ†¶é«”: 92.15%
[2026-01-03 15:20:20] ğŸ’¥ ä¼ºæœå™¨å´©æ½° (OOM)
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè­°

### ç«‹å³å¯åš
1. âœ… æ¸¬è©¦ç›£æ§è…³æœ¬ï¼š`node monitor.js`
2. âœ… è¨­å®š Uptime Robot ç›£æ§ç”Ÿç”¢ä¼ºæœå™¨
3. âœ… æª¢è¦– `/metrics` ç«¯é»ç¢ºèªè³‡æ–™æ­£ç¢º

### é€²éšå„ªåŒ–
1. ğŸ”„ æ•´åˆ Grafana Dashboard
2. ğŸ”„ è¨­å®š Slack/Discord è­¦å ±æ©Ÿå™¨äºº
3. ğŸ”„ å¯¦ä½œè‡ªå‹•æ“´å®¹è…³æœ¬

---

**å»ºç«‹æ™‚é–“ï¼š** 2026-01-03  
**é©ç”¨ç‰ˆæœ¬ï¼š** Zen Gomoku Game v1.0+  
**ç¶­è­·è€…ï¼š** Robin Li
