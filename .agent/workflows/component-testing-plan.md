# 組件測試計劃

**日期**: 2026-01-15  
**項目**: 靜弈五子棋 - 組件測試

---

## 📋 需要測試的組件清單

### 🔴 高優先級組件（核心功能）

#### 1. **Board.tsx** (~8.4KB)
**複雜度**: ⭐⭐⭐⭐⭐  
**優先級**: 🔴 最高  
**預估測試數**: 15-20 個

**測試範圍**:
- ✅ 棋盤渲染（15x15 網格）
- ✅ 棋子放置和顯示
- ✅ 點擊事件處理
- ✅ 勝利線條高亮
- ✅ 威脅提示顯示
- ✅ 最後一步標記
- ✅ 禁用狀態
- ✅ 回放模式
- ✅ 響應式布局

**依賴**:
- GameRoom 類型
- Position 類型
- WinLine 類型

---

#### 2. **GameInfo.tsx** (~14.5KB)
**複雜度**: ⭐⭐⭐⭐⭐  
**優先級**: 🔴 最高  
**預估測試數**: 20-25 個

**測試範圍**:
- ✅ 遊戲狀態顯示（回合、玩家）
- ✅ 房間信息顯示
- ✅ 分享連結功能
- ✅ 統計數據顯示
- ✅ 按鈕狀態（悔棋、重置、回放）
- ✅ 勝利/平局提示
- ✅ 等待狀態顯示
- ✅ 複製功能
- ✅ 國際化文本

**依賴**:
- GameRoom 類型
- Player 類型
- RoomStats 類型
- i18next

---

#### 3. **ReplayControls.tsx** (~7.6KB)
**複雜度**: ⭐⭐⭐⭐  
**優先級**: 🔴 高  
**預估測試數**: 12-15 個

**測試範圍**:
- ✅ 播放/暫停按鈕
- ✅ 上一步/下一步按鈕
- ✅ 快進/重新開始按鈕
- ✅ 進度條顯示
- ✅ 步驟信息顯示
- ✅ 按鈕禁用狀態
- ✅ 鍵盤快捷鍵
- ✅ 退出回放

**依賴**:
- useReplay hook
- MoveHistory 類型

---

### 🟡 中優先級組件（對話框）

#### 4. **UndoRequestDialog.tsx** (~2.6KB)
**複雜度**: ⭐⭐⭐  
**優先級**: 🟡 中  
**預估測試數**: 8-10 個

**測試範圍**:
- ✅ 對話框顯示/隱藏
- ✅ 請求者信息顯示
- ✅ 同意/拒絕按鈕
- ✅ 回調函數調用
- ✅ 國際化文本
- ✅ 動畫效果

**依賴**:
- BaseDialog
- Player 類型

---

#### 5. **ResetRequestDialog.tsx** (~2.6KB)
**複雜度**: ⭐⭐⭐  
**優先級**: 🟡 中  
**預估測試數**: 8-10 個

**測試範圍**:
- ✅ 對話框顯示/隱藏
- ✅ 請求者信息顯示
- ✅ 同意/拒絕按鈕
- ✅ 回調函數調用
- ✅ 國際化文本

**依賴**:
- BaseDialog
- Player 類型

---

#### 6. **MessageDialog.tsx** (~1.1KB)
**複雜度**: ⭐⭐  
**優先級**: 🟡 中  
**預估測試數**: 6-8 個

**測試範圍**:
- ✅ 對話框顯示/隱藏
- ✅ 標題和訊息顯示
- ✅ 圖標顯示（success, error, info）
- ✅ 確認按鈕
- ✅ 回調函數調用

**依賴**:
- BaseDialog

---

#### 7. **ConfirmDialog.tsx** (~1.5KB)
**複雜度**: ⭐⭐  
**優先級**: 🟡 中  
**預估測試數**: 6-8 個

**測試範圍**:
- ✅ 對話框顯示/隱藏
- ✅ 標題和訊息顯示
- ✅ 確認/取消按鈕
- ✅ 回調函數調用

**依賴**:
- BaseDialog

---

### 🟢 低優先級組件（輔助功能）

#### 8. **Lobby.tsx** (~4.5KB)
**複雜度**: ⭐⭐⭐  
**優先級**: 🟢 低  
**預估測試數**: 10-12 個

**測試範圍**:
- ✅ 創建房間表單
- ✅ 加入房間表單
- ✅ 輸入驗證
- ✅ 提交處理
- ✅ 錯誤顯示
- ✅ 國際化文本

**依賴**:
- RoomSettings
- SocketService

---

#### 9. **RoomSettings.tsx** (~2.2KB)
**複雜度**: ⭐⭐  
**優先級**: 🟢 低  
**預估測試數**: 8-10 個

**測試範圍**:
- ✅ 設置選項顯示
- ✅ 悔棋次數選擇
- ✅ 時間限制選擇
- ✅ 值變更處理
- ✅ 國際化文本

**依賴**:
- RoomSettings 類型

---

#### 10. **LanguageSwitcher.tsx** (~1.2KB)
**複雜度**: ⭐  
**優先級**: 🟢 低  
**預估測試數**: 4-6 個

**測試範圍**:
- ✅ 語言選項顯示
- ✅ 當前語言標記
- ✅ 切換語言功能
- ✅ i18next 集成

**依賴**:
- i18next

---

#### 11. **BaseDialog.tsx** (~3.3KB)
**複雜度**: ⭐⭐  
**優先級**: 🟢 低  
**預估測試數**: 6-8 個

**測試範圍**:
- ✅ 對話框渲染
- ✅ 顯示/隱藏動畫
- ✅ 背景遮罩
- ✅ 子組件渲染
- ✅ 關閉功能

**依賴**:
- 無（基礎組件）

---

#### 12. **DialogButton.tsx** (~656B)
**複雜度**: ⭐  
**優先級**: 🟢 低  
**預估測試數**: 4-5 個

**測試範圍**:
- ✅ 按鈕渲染
- ✅ 點擊事件
- ✅ 樣式變體（primary, secondary）
- ✅ 禁用狀態

**依賴**:
- 無（基礎組件）

---

## 📊 測試統計預估

### 總計
- **組件數量**: 12 個
- **預估測試數**: 110-140 個
- **預估工時**: 15-20 小時

### 按優先級分布
- **高優先級**: 3 個組件，47-60 個測試
- **中優先級**: 4 個組件，34-44 個測試
- **低優先級**: 5 個組件，29-36 個測試

### 按複雜度分布
- **⭐⭐⭐⭐⭐**: 2 個（Board, GameInfo）
- **⭐⭐⭐⭐**: 1 個（ReplayControls）
- **⭐⭐⭐**: 4 個（UndoRequestDialog, ResetRequestDialog, Lobby, BaseDialog）
- **⭐⭐**: 4 個（MessageDialog, ConfirmDialog, RoomSettings, DialogButton）
- **⭐**: 1 個（LanguageSwitcher）

---

## 🎯 建議的測試順序

### 階段 1：基礎組件（2-3 小時）
1. **DialogButton** - 最簡單，建立測試模式
2. **BaseDialog** - 其他對話框的基礎
3. **LanguageSwitcher** - 簡單的功能組件

### 階段 2：對話框組件（4-5 小時）
4. **MessageDialog** - 簡單對話框
5. **ConfirmDialog** - 確認對話框
6. **UndoRequestDialog** - 遊戲對話框
7. **ResetRequestDialog** - 遊戲對話框

### 階段 3：核心遊戲組件（8-10 小時）
8. **Board** - 最重要的組件
9. **GameInfo** - 複雜的信息顯示
10. **ReplayControls** - 回放控制

### 階段 4：輔助組件（2-3 小時）
11. **RoomSettings** - 設置組件
12. **Lobby** - 大廳組件

---

## 🛠️ 測試技術需求

### 需要的工具
- ✅ React Testing Library（已安裝）
- ✅ Vitest（已安裝）
- ✅ @testing-library/user-event（需要安裝）
- ⏳ @testing-library/jest-dom（已安裝）

### 需要 Mock 的內容
- ✅ i18next（已有範例）
- ⏳ SocketService
- ⏳ window.navigator.clipboard
- ⏳ Canvas API（Board 組件）

### 測試策略
1. **單元測試** - 測試組件的獨立功能
2. **集成測試** - 測試組件之間的交互
3. **快照測試** - 測試 UI 結構（可選）
4. **可訪問性測試** - 測試 a11y（可選）

---

## 📝 測試範例結構

```typescript
describe('ComponentName', () => {
    describe('渲染', () => {
        it('應該正確渲染基本結構', () => {});
        it('應該顯示正確的文本', () => {});
    });

    describe('交互', () => {
        it('應該處理點擊事件', () => {});
        it('應該處理輸入變更', () => {});
    });

    describe('狀態', () => {
        it('應該正確更新狀態', () => {});
        it('應該處理禁用狀態', () => {});
    });

    describe('邊界情況', () => {
        it('應該處理空值', () => {});
        it('應該處理錯誤', () => {});
    });
});
```

---

## 🚀 下一步行動

### 立即開始
1. **安裝 @testing-library/user-event**
2. **創建 DialogButton 測試**（最簡單）
3. **創建 BaseDialog 測試**（基礎組件）

### 本週目標
- 完成所有基礎組件測試（階段 1）
- 完成所有對話框組件測試（階段 2）
- 開始核心遊戲組件測試（階段 3）

### 本月目標
- 完成所有組件測試
- 達到 80%+ 代碼覆蓋率
- 設置 CI/CD 自動測試

---

**總結**: 共有 12 個組件需要測試，預估 110-140 個測試用例。建議從簡單的基礎組件開始，逐步推進到複雜的核心組件。優先測試高優先級組件（Board, GameInfo, ReplayControls），因為它們是遊戲的核心功能。
